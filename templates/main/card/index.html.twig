{% import "macros/search.html.twig" as search %}

{% extends 'base.html.twig' %}


{% block title %}Hello CardController!{% endblock %}

{% block body %}
{{ search.search(form) }}
<ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{{ path('articles') }}">Tous les articles</a></li>
    <li class="breadcrumb-item active">Cart</li>
</ol>
  {% for item in app.flashes('success') %}
  <div class="alert alert-success">
      <p>{{item}}</p>
  </div>
  {% endfor %}
<div class="row">
  <div class="col-lg-8">
    <div class="card">
    <div class="card-header">
      <h4>Card</h4>
    </div>
{% if app.request.session.get('panier')%}
      <div class="card-body">
            <table class="table">
              <thead>
                <th>X</th>
                <th>Image</th>
                <th>Name</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Subtotal</th>
              </thead>
              
              <tbody>
              {% for key, item in items %}
                <tr>
                  <td>
                    <a href="{{ path('card_delete',{id: item.article.id} ) }}" class="btn-sm"><i class="fa fa-window-close text-danger" aria-hidden="true"></i></a>
                  </td>
                  <td><img src="{{ asset('img/vide.png') }}" width="80px" alt=""> </td>
                  <td>{{ item.article.title}} </td>
                  <td>
                      <form class="form-row" action="" method="post">
                        <div class="form-group col-6">
                        <input type="hidden" name="article_id" value="{{ item.article.id }}">
                          <input type="number" class="form-control" min="1" max="{{ item.article.quantity }}" name="qty" value="{{ item.quantite }}" >
                          <small id="helpId" class="text-muted">Stock: {{ item.article.quantity  }} </small>
                        </div>
                        <div class="form-group col-2">
                          <button type="submit" class="btn btn-success ml-1">
                            Appliquer
                          </button>
                        </div>
                      </form>
                  </td>
                  <td>
                      {{ item.article.price|number_format(2,'.',' ') }} XOF
                  </td>
                  <td>
                      {{ (item.article.price * item.quantite) | number_format(2,'.',' ') }} XOF
                  </td>
                </tr>
              {% endfor %}
              </tbody>
            </table>
            <div class="row">
              <div class="col-lg-6 offset-6 ">
                <table class="table">
                  {# <tr>
                    <td>Total Subtoal</td>
                    <td></td>
                  </tr> #}
                  {# <tr>
                    <td>Shipping</td>
                    <td> 1000 XOF</td>
                  </tr> #}
                  <tr>
                    <td>Total :</td>
                    <td> {{ total|number_format(2,'.',' ') }} XOF</td>
                  </tr>
                </table>
                {# <a  href="#">
                  Commander
                </a> #}
                <div class="btn-group">
                  {% if app.session.get('panier') != [] %}
                  <a href="{{ path('order_user') }}" class="btn btn-lg ml-1 rounded btn-primary" type="submit">
                    Commander
                  </a>
                  <a href="{{ path('card_clear') }}" class="btn-danger btn-lg ml-1">
                    Clear <i class="fa fa-trash" aria-hidden="true"></i>
                  </a>
                  {% endif %}
                </div>
              </div>
            </div>
      </div>
{% else %}
     <div class="card-body text-center">
       <h3>Empty cart</h3>
       <a class="btn bg-danger bnt-success p-5 rounded-circle" href="#">
        <i class="fa fa-cart-arrow-down fa-4x" aria-hidden="true"></i>
       </a></br>
       <a href="{{ path('articles') }}">add products</a>
     </div>
     <div class="card-footer">
          <a class="link-default 2rem" href="{{ path('articles') }}">
            Visualiliser d'autre articles
          </a>
     </div>
    </div>
  </div>
  
{% endif %}

  <div class="col-lg-4">
  <div class="card card-outine card-primary">
    <div class="card-body">
    <h4>Article</h4>
    </div>
  </div>
  </div>
</div>
{% endblock %}
